---
import { markdownify } from "@/lib/utils/textConverter";
import ImageMod from "@/components/ImageMod.astro";
const { testimonial } = Astro.props;
---

{
  testimonial.data.enable && (
    <section class="section bg-black">
      <div class="container">
        <div class="row">
          <div class="mx-auto mb-12 text-center md:col-10 lg:col-8 xl:col-6">
            <h2 set:html={markdownify(testimonial.data.title)} class="mb-4 text-white" />
            <p set:html={markdownify(testimonial.data.description)} class="text-white" />
          </div>
          <div class="col-12">
            <div class="columns-1 md:columns-2 lg:columns-3 gap-0 space-y-0">
              {testimonial.data.testimonials.map(
                (item: {
                  avatar: string;
                  content: string;
                  name: string;
                  designation: string;
                  npub?: string;
                  noteid?: string;
                }) => (
                  <div class="testimonial-card break-inside-avoid mb-0">
                    <blockquote
                      class="text-white italic mb-6 text-lg"
                      set:text={item.content}
                    />
                    <div class="flex items-center">
                      <div class="text-white">
                        {(item.noteid || item.npub) ? (
                          <a
                            href={`https://njump.me/${item.noteid || item.npub}`}
                            target="_blank"
                            rel="noopener noreferrer"
                            class="cursor-pointer hover:opacity-80 transition-opacity"
                          >
                            <img
                              height={50}
                              width={50}
                              class="border border-white showcase-logo"
                              src={item.avatar}
                              alt={item.name}
                            />
                          </a>
                        ) : (
                          <img
                            height={50}
                            width={50}
                            class="border border-white showcase-logo"
                            src={item.avatar}
                            alt={item.name}
                          />
                        )}
                      </div>
                      <div class="ml-4">
                        {(item.noteid || item.npub) ? (
                          <a
                            href={`https://njump.me/${item.noteid || item.npub}`}
                            target="_blank"
                            rel="noopener noreferrer"
                            class="cursor-pointer hover:opacity-80 transition-opacity"
                          >
                            <h3
                              set:text={item.name}
                              class="text-sm font-primary font-semibold text-white mb-1"
                            />
                          </a>
                        ) : (
                          <h3
                            set:text={item.name}
                            class="text-sm font-primary font-semibold text-white mb-1"
                          />
                        )}
                        <p
                          set:text={item.designation}
                          class="text-white text-sm"
                        />
                      </div>
                    </div>
                  </div>
                )
              )}
            </div>
          </div>
        </div>
      </div>
    </section>
  )
}

<style>
  .testimonial-card {
    background-color: black;
    padding: 1.5rem;
    border-bottom: 1px solid white;
    break-inside: avoid;
    display: inline-block;
    width: 100%;
  }

  .showcase-logo img {
    filter: contrast(1000%) grayscale(100%) !important;
    image-rendering: pixelated !important;
    image-rendering: crisp-edges !important;
    transition: filter 0.3s ease !important;
  }

  .showcase-logo:hover img {
    filter: none !important;
  }
  
  .showcase-logo {
    filter: contrast(1000%) grayscale(100%) !important;
    image-rendering: pixelated !important;
    image-rendering: crisp-edges !important;
    transition: filter 0.3s ease !important;
  }

  .showcase-logo:hover {
    filter: none !important;
  }

  /* Fix quote marks to be straight quotes */
  blockquote {
    font-family: "IM Fell Double Pica", Times, serif;
  }
  
  blockquote::before {
    content: '"';
  }
  
  blockquote::after {
    content: '"';
  }
</style>