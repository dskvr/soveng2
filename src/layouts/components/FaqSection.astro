---
import { markdownify } from "@/lib/utils/textConverter";

interface Question {
  question: string;
  answer: string;
}

interface Props {
  title: string;
  questions: Question[];
  index: number;
  id?: string;
  image?: string;
  content?: string;
}

const { title, questions, index, id, image, content } = Astro.props;

// Pre-process markdown content
const sectionTitle = await markdownify(title);

// Process questions and answers
const processedQuestions = await Promise.all(
  questions.map(async (qa: Question) => ({
    question: await markdownify(qa.question),
    answer: await markdownify(qa.answer, true)
  }))
);
---

<section 
  class="section-sm bg-black text-white"
  id={id}
>
  <div class="container">
    <div class="row justify-center">
      <div class="md:col-10 lg:col-8">
        <h2 set:html={sectionTitle} class="mb-8 text-white uppercase text-center" style="font-size: 2rem;" />

        {content && (
          <div class="space-y-8 mb-8 text-xl text-white faq-content" set:html={content} />
        )}
        
        <div class="space-y-8">
          {processedQuestions.map((qa: any) => (
            <div class="faq-item">
              <h3 class="text-xl font-bold text-white mb-4 uppercase" set:html={qa.question} />
              <div set:html={qa.answer} class="faq-content text-white" />
            </div>
          ))}
        </div>

        {image && (
          <div class="mt-8">
            <img
              src={image}
              alt={title}
              class="feature-image w-full rounded-lg"
            />
          </div>
        )}
      </div>
    </div>
  </div>
</section>

<style>
  .feature-image {
    image-rendering: auto !important;
    image-rendering: smooth !important;
    image-rendering: high-quality !important;
    image-rendering: -webkit-optimize-contrast !important;
    max-width: 100%;
    height: auto;
  }
  
  .faq-item {
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    padding-bottom: 2rem;
  }
  
  .faq-item:last-child {
    border-bottom: none;
    padding-bottom: 0;
  }

  .faq-content p {
    font-size: 1.125rem !important; /* text-lg */
    color: white !important;
    margin-bottom: 1rem !important;
  }

  .faq-content ul {
    margin-bottom: 1rem !important;
    list-style-type: disc !important;
    padding-left: 1.5rem !important;
  }

  .faq-content li {
    font-size: 1.125rem !important; /* text-lg */
    color: white !important;
    margin-bottom: 0.5rem !important;
  }

  .faq-content a {
    font-size: 1.125rem !important; /* text-lg */
    color: white !important;
    text-decoration: underline !important;
  }

  .faq-content a:hover {
    color: #10b981 !important; /* primary color */
  }
</style> 